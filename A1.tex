\documentclass{article}

\usepackage{graphicx}
\usepackage{subcaption}
\usepackage[hypcap]{caption}
\usepackage{listings}

\title{Experimental Design and Data Analysis: Assignment 1}
\author{Andrew Bedard \& Simone van Gompel(2567525) \\ Group 19}

\begin{document}

  \maketitle

  \section{Exercise 1}
    For the datas X1 and X4 you cannot say if it is normally distributed.
    The random normal data of the same size also doesn't give a clear result in the QQ-plot.
    See this in Fig:\ref{fig:X1} and Fig:\ref{fig:X4}.\\
    The datas X2 and X5 are not normally distributed.
    The normally distributed data of the same size gives a straight line and X2, X5 does not.
    See this in Fig:\ref{fig:X2} and Fig:\ref{fig:X5}.\\
    The data X3 is probably normally distributed.
    The drawn line is straight enough to be able to conclude this, it resembles the normally distributed data of the same size.
    See this in Fig:\ref{fig:X3}.\\
    See the used code in:\ref{sub:R1}

    \begin{figure}
    \begin{subfigure}{.5\textwidth}
      \centering
      \includegraphics[width=.8\linewidth]{results/X1}
      \caption{X1 Data}
    \end{subfigure}
    \begin{subfigure}{.5\textwidth}
      \centering
      \includegraphics[width=.8\linewidth]{results/X1_2}
      \caption{Rnorm data of same size}
    \end{subfigure}
    \caption{X1}
    \label{fig:X1}
    \end{figure}

    \begin{figure}
    \begin{subfigure}{.5\textwidth}
      \centering
      \includegraphics[width=.8\linewidth]{results/X2}
      \caption{X2 Data}
    \end{subfigure}
    \begin{subfigure}{.5\textwidth}
      \centering
      \includegraphics[width=.8\linewidth]{results/X2_2}
      \caption{Rnorm data of same size}
    \end{subfigure}
    \caption{X2}
    \label{fig:X2}
    \end{figure}

    \begin{figure}
    \begin{subfigure}{.5\textwidth}
      \centering
      \includegraphics[width=.8\linewidth]{results/X3}
      \caption{X3 Data}
    \end{subfigure}
    \begin{subfigure}{.5\textwidth}
      \centering
      \includegraphics[width=.8\linewidth]{results/X3_2}
      \caption{Rnorm data of same size}
    \end{subfigure}
    \caption{X3}
    \label{fig:X3}
    \end{figure}

    \begin{figure}
    \begin{subfigure}{.5\textwidth}
      \centering
      \includegraphics[width=.8\linewidth]{results/X4}
      \caption{X4 Data}
    \end{subfigure}
    \begin{subfigure}{.5\textwidth}
      \centering
      \includegraphics[width=.8\linewidth]{results/X4_2}
      \caption{Rnorm data of same size}
    \end{subfigure}
    \caption{X4}
    \label{fig:X4}
    \end{figure}

    \begin{figure}
    \begin{subfigure}{.5\textwidth}
      \centering
      \includegraphics[width=.8\linewidth]{results/X5}
      \caption{X5 Data}
    \end{subfigure}
    \begin{subfigure}{.5\textwidth}
      \centering
      \includegraphics[width=.8\linewidth]{results/X5_2}
      \caption{Rnorm data of same size}
    \end{subfigure}
    \caption{X5}
    \label{fig:X5}
    \end{figure}

  \section{Exercise 2}

    \subsection{2.1}
      After running the simulation the following results were obtained:
      \begin{itemize}
        \item Number of p-values smaller than 5\%: 44
        \item Number of p-values smaller than 10\%: 93
        \item The histogram Fig:\ref{fig:2_1}
      \end{itemize}

      \begin{figure}
        \centering
        \includegraphics[width=.8\linewidth]{results/2_1}
        \caption{Histogram p-values}
        \label{fig:2_1}
      \end{figure}

    \subsection{2.2}
      After running the simulation the following results were obtained:
      \begin{itemize}
        \item Number of p-values smaller than 5\%: 52
        \item Number of p-values smaller than 10\%: 106
        \item The histogram Fig:\ref{fig:2_2}
      \end{itemize}
      
      \begin{figure}
        \centering
        \includegraphics[width=.8\linewidth]{results/2_2}
        \caption{Histogram p-values}
        \label{fig:2_2}
      \end{figure}


    \subsection{2.3}
      After running the simulation the following results were obtained:
      \begin{itemize}
        \item Number of p-values smaller than 5\%: 966
        \item Number of p-values smaller than 10\%: 984
        \item The histogram Fig:\ref{fig:2_3}
      \end{itemize}
      
      \begin{figure}
        \centering
        \includegraphics[width=.8\linewidth]{results/2_3}
        \caption{Histogram p-values}
        \label{fig:2_3}
      \end{figure}
      

    \subsection{2.4}
      Discuss the results....
      

  \section{Exercise 3}

    \subsection{3.1}
      See Fig:\ref{fig:3_1}.
      \begin{figure}
        \centering
        \includegraphics[width=.8\linewidth]{results/3_1}
        \caption{P-values as a function of nu}
        \label{fig:3_1}
      \end{figure}

    \subsection{3.2}
      See Fig:\ref{fig:3_2}.
      \begin{figure}
        \centering
        \includegraphics[width=.8\linewidth]{results/3_2}
        \caption{P-values as a function of nu}
        \label{fig:3_2}
      \end{figure}

    \subsection{3.3}
      See Fig:\ref{fig:3_3}.
      \begin{figure}
        \centering
        \includegraphics[width=.8\linewidth]{results/3_3}
        \caption{P-values as a function of nu}
        \label{fig:3_3}
      \end{figure}

    \subsection{3.4}
      Discuss the results....

  \section{R-Code}
    \subsection{Exercise 1}\label{sub:R1}
      \begin{lstlisting}[language=R]
        load(file="assign1.RData")

        par(mfrow=c(1,2))
        hist(x1)
        qqnorm(x1)

        hist(x2)
        qqnorm(x2)

        hist(x3)
        qqnorm(x3)

        hist(x4)
        qqnorm(x4)

        hist(x5)
        qqnorm(x5)

        par(mfrow=c(1,1))
        par(pin=c(2.5,5))
        qqnorm(rnorm(20))
        qqnorm(rnorm(100))
        qqnorm(rnorm(100))
        qqnorm(rnorm(30))
        qqnorm(rnorm(40))
      \end{lstlisting}

    \subsection{Exercise 2}\label{sub:R2}
      \begin{lstlisting}[language=R]
        #2.1
        m=30
        n=30
        mu=180
        nu=180
        sd=10
        B=1000
        p=numeric(B)

        for (b in 1:B) {
          x=rnorm(m,mu,sd)
          y=rnorm(n,nu,sd)
          p[b]=t.test(x,y,var.equal=TRUE)[[3]]
        }

        sum(p<0.05)
        sum(p<0.1)
        par(pin=c(5,5))
        hist(p)

        #2.2
        sd=1
        p=numeric(B)

        for (b in 1:B) {
          x=rnorm(m,mu,sd)
          y=rnorm(n,nu,sd)
          p[b]=t.test(x,y,var.equal=TRUE)[[3]]
        }

        sum(p<0.05)
        sum(p<0.1)
        hist(p)

        #2.3
        nu=175
        sd=5
        p=numeric(B)

        for (b in 1:B) {
          x=rnorm(m,mu,sd)
          y=rnorm(n,nu,sd)
          p[b]=t.test(x,y,var.equal=TRUE)[[3]]
        }

        sum(p<0.05)
        sum(p<0.1)
        hist(p)
      \end{lstlisting}

    \subsection{Exercise 3}\label{sub:R3}
      \begin{lstlisting}[language=R]
        #3.1
        m=30
        n=30
        mu=180
        nu = seq(175,185,by=0.1)
        sd=5
        p = numeric(length(nu))
        b = 0

        for (nu_tmp in nu) {
          b=b+1
          x=rnorm(m,mu,sd)
          y=rnorm(n,nu_tmp,sd)
          p[b]=t.test(x,y,var.equal=TRUE)[[3]]
        }

        plot(nu, p)


        #3.2
        m=100
        n=100
        p = numeric(length(nu))
        b = 0

        for (nu_tmp in nu) {
          b=b+1
          x=rnorm(m,mu,sd)
          y=rnorm(n,nu_tmp,sd)
          p[b]=t.test(x,y,var.equal=TRUE)[[3]]
        }

        plot(nu, p)


        #3.3
        m=30
        n=30
        sd=100
        p = numeric(length(nu))
        b = 0

        for (nu_tmp in nu) {
          b=b+1
          x=rnorm(m,mu,sd)
          y=rnorm(n,nu_tmp,sd)
          p[b]=t.test(x,y,var.equal=TRUE)[[3]]
        }

        plot(nu, p)
      \end{lstlisting}

\end{document}